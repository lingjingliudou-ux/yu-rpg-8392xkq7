<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ゆうしゃのRPG</title>
<style>
body{
  background:#111;
  color:#fff;
  font-family:monospace;
  text-align:center;
}

#game{
  max-width:500px;
  margin:auto;
  padding:20px;
  background:#222;
  border:4px solid #fff;
}

button{
  margin:5px;
  padding:10px;
  background:black;
  color:white;
  border:2px solid white;
  font-size:16px;
}

button:hover{
  background:white;
  color:black;
}

#log{
  margin-top:15px;
  text-align:left;
  min-height:120px;
  background:black;
  padding:10px;
  border:2px solid white;
}
</style>
</head>
<body>

<div id="game">
  <h1>ゆうしゃのぼうけん</h1>
  <p id="status"></p>

  <button onclick="startBattle()">▶ モンスター出現</button>

  <div id="commandBox" style="display:none;">
    <h3>コマンド</h3>
    <button onclick="fight()">たたかう</button>
    <button onclick="spell()">じゅもん</button>
    <button onclick="heal()">かいふく</button>
    <button onclick="runAway()">にげる</button>
  </div>

  <div id="log"></div>
</div>

<script>
let hero = { hp:30, maxHp:30 };
let enemy;

function updateStatus(){
  document.getElementById("status").innerText =
    "ゆうしゃ HP: " + hero.hp +
    (enemy ? " | スライム HP: " + enemy.hp : "");
}

function log(text){
  document.getElementById("log").innerHTML += text + "<br>";
  document.getElementById("log").scrollTop =
    document.getElementById("log").scrollHeight;
}

function startBattle(){
  enemy = { hp:20 };
  log("スライムがあらわれた！");
  document.getElementById("commandBox").style.display="block";
  updateStatus();
}

function fight(){
  let damage = Math.floor(Math.random()*6)+3;
  enemy.hp -= damage;
  log("ゆうしゃの攻撃！ "+damage+" ダメージ！");
  checkEnemy();
}

function spell(){
  let damage = Math.floor(Math.random()*10)+5;
  enemy.hp -= damage;
  log("メラ！ "+damage+" ダメージ！");
  checkEnemy();
}

function heal(){
  let heal = Math.floor(Math.random()*8)+5;
  hero.hp += heal;
  if(hero.hp > hero.maxHp) hero.hp = hero.maxHp;
  log("ホイミ！ "+heal+" 回復！");
  enemyTurn();
  updateStatus();
}

function runAway(){
  log("ゆうしゃは にげだした！");
  document.getElementById("commandBox").style.display="none";
  enemy = null;
  updateStatus();
}

function checkEnemy(){
  if(enemy.hp <= 0){
    log("スライムをたおした！");
    document.getElementById("commandBox").style.display="none";
    enemy = null;
  } else {
    enemyTurn();
  }
  updateStatus();
}

function enemyTurn(){
  let damage = Math.floor(Math.random()*5)+2;
  hero.hp -= damage;
  log("スライムの攻撃！ "+damage+" ダメージ！");
  if(hero.hp <= 0){
    log("ゆうしゃは たおれた…");
    document.getElementById("commandBox").style.display="none";
  }
  updateStatus();
}

updateStatus();
</script>

</body>
</html>
